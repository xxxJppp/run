<html lang="en" style="font-size: 100px;">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
    <link rel="icon" href="/favicon.ico">
    <title>h8pay</title>
    <style>body {
        background: #f2f2f2;
    }

    @media screen and (min-width: 767px) {
        #app {
            width: 540px;
            margin: 0 auto;
            min-height: 100vh;
            box-sizing: border-box;
            border: 1px solid #999;
            /* overflow-y: hidden; */
        }

        .van-popup--top {
            width: 540px;
            margin: 0 auto;
        }
    }</style>

    <link href="__HOME__/css/app.2150f8cc.css" rel="preload" as="style">
    <link href="__HOME__/css/chunk-vendors.e9f6096e.css" rel="preload" as="style">
    <link href="__HOME__/css/app.7b6aaa54.js" rel="preload" as="script">
    <link href="__HOME__/css/chunk-vendors.9dc788ca.js" rel="preload" as="script">
    <link href="__HOME__/css/chunk-vendors.e9f6096e.css" rel="stylesheet">
    <link href="__HOME__/css/app.2150f8cc.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-43155bdd.7506223a.css">
    <script charset="utf-8" src="__HOME__/css/chunk-43155bdd.e84d6a1d.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-fde07e7a.adc0509a.css">
    <script charset="utf-8" src="__HOME__/css/chunk-fde07e7a.d481bd8c.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-57d8499b.96222562.css">
    <script charset="utf-8" src="__HOME__/css/chunk-57d8499b.a72ea326.js"></script>
    <script charset="utf-8" src="__HOME__/css/chunk-2d0f0c02.2926760c.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-38d9c4e3.72558616.css">
    <script charset="utf-8" src="__HOME__/css/chunk-38d9c4e3.8ea2ebe4.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-24229c8f.122b5dbc.css">
    <script charset="utf-8" src="__HOME__/css/chunk-24229c8f.46929d5e.js"></script>
    <script charset="utf-8" src="__HOME__/css/chunk-2c41e510.2c195371.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-9fea3c5c.531c8116.css">
    <script charset="utf-8" src="__HOME__/css/chunk-9fea3c5c.ffde5972.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-ae7bdc24.38e0efd9.css">
    <script charset="utf-8" src="__HOME__/css/chunk-ae7bdc24.95a06cff.js"></script>
    <link rel="stylesheet" type="text/css" href="__HOME__/css/chunk-e1f1707a.079dd8a4.css">
    <script charset="utf-8" src="__HOME__/css/chunk-e1f1707a.6a487118.js"></script>
    <script>
        if (('standalone' in window.navigator) && window.navigator.standalone) {
            var noddy, remotes = false;
            document.addEventListener('click', function (event) {
                noddy = event.target;
                while (noddy.nodeName !== 'A' && noddy.nodeName !== 'HTML') noddy = noddy.parentNode;
                if ('href' in noddy && noddy.href.indexOf('http') !== -1 && (noddy.href.indexOf(document.location.host) !== -1 || remotes)) {
                    event.preventDefault();
                    document.location.href = noddy.href;
                }
            }, false);
        }
    </script>
</head>
<body class="">

<div id="app">
    <div data-v-7d5a3782="" class="pwd-reset">
        <div data-v-7d5a3782="" class="MB10 van-nav-bar van-hairline--bottom" style="z-index: 1;">
            <div data-v-7d5a3782="" class="van-nav-bar__left" onClick="javascript :history.back(-1);"><i
                    data-v-7d5a3782="" class="van-icon van-icon-arrow-left van-nav-bar__arrow"><!----></i>
                <span data-v-7d5a3782="" class="van-nav-bar__text">返回</span></div>
                <div data-v-7d5a3782="" class="van-nav-bar__title van-ellipsis" >谷歌验证码绑定</div>
                <div data-v-7d5a3782="" class="van-nav-bar__right" style="bottom: 10px;">
                    <!--<span data-v-7d5a3782="" class="van-nav-bar__text" style="height: 24px; background-color: #1677FE;border-radius: 5px; color: 12px;line-height: 24px;" id="submit" onclick="setps()">确认绑定</span>--></div>
        </div>
        <div data-v-7d5a3782="" class="pwd-info">
            <div data-v-7d5a3782="">
                <div class="builder formbuilder-box">
                    <div class="form-group"></div>
                    <div class="builder-container" >

                        <div>
                            <div class="">
                                <p class="">两步验证</p>
                                <p>请下载 Google 的两步验证器。</p>
                                <p><i class="fa fa-android"></i><a id="android" href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">&nbsp;Android</a></p>
                                <p><i class="fa fa-apple"></i><a id="ios" href="https://itunes.apple.com/cn/app/google-authenticator/id388497605?mt=8">&nbsp;iOS</a></p>

                                <p>如果遇到问题，请参考：<a href="https://phpartisan.cn/specials/5" target="_blank">Google Authenticator帮助文档</a></p>

                                <!--<p style="color:red">在没有测试完成绑定成功之前请不要启用。</p>
                                <p>当前设置：<?php if($info['is_open_google_auth']){ ?> <code> 要求验证 </code><?php }else{ ?> <code> 不要求验证 </code>  <?php } ?></p>
                                <p>当前服务器时间：<span class="text-red" id="txt"></span></p>
                                <div class="form-group form-group-label control-highlight-custom dropdown control-highlight">
                                    <label class="floating-label" for="ga-enable">验证设置</label>
                                    <button type="button" id="ga-enable" class="form-control maxwidth-edit" data-toggle="dropdown" value="<?php if($info['is_open_google_auth'] || empty($info['google_auth'])){ ?>1<?php }else{ ?>0<?php } ?>">
                                        <?php if($info['is_open_google_auth'] || empty($info['google_auth'])){ ?>   要求验证 </code><?php }else{ ?> 不要求验证  <?php } ?>
                                    </button>
                                    <ul class="dropdown-menu text-center"  style="width: 100%;border-radius: unset;box-shadow: 0 6px 12px rgba(0,0,0,.175);">
                                        <li><a class="yes_auth" >要求验证</a></li>
                                        <li><a class="no_auth" >不要求</a> </li>

                                    </ul>
                                </div>-->
                                <p>当前设置：<?php if($info['google_auth']){ ?> <code> 已绑定(如果要重新绑定请先刷新密钥再扫新的二维码)</code><?php }else{ ?> <code> 未绑定 </code>  <?php } ?></p>
                                <div class="form-group form-group-label control-highlight-custom dropdown control-highlight">
                                    <button type="button" id="ga-enable" class="form-control maxwidth-edit" data-toggle="dropdown" value="<?php if($info['is_open_google_auth'] || empty($info['google_auth'])){ ?>1<?php }else{ ?>0<?php } ?>">
                                        <b><font color="red">刷新密钥</font></b>
                                    </button>
                                </div>
                                <div class="form-group form-group-label">
                                    <div class="text-center">
                                        <div>
                                            <img src = "{$qrcode}" height="200" width="200" id="qrcode"/>
                                        </div>
                                        <h4 class="">
                                            密钥：<span class="text-red" id="secret">{$createSecret}</span>
                                        </h4>
                                    </div>
                                </div>
                                <div class="form-group form-group-label">
                                    <label class="floating-label" for="code">下载goole验证器后扫码生成验证码输入下面绑定账号</label>
                                    <input type="hidden" name="google" value="{$createSecret}" />
                                    <input name="onecode" class="form-control"  type="text" placeholder="请输入6位验证码" value="" />
                                </div>
                            </div>
                            <div class="form-group text-center">
                                <div class="">
                                    <button class="btn btn-primary test"><?php if($info['google_auth']){ ?> 重新绑定<?php }else{ ?> 设置<?php } ?></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="__COM__/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="__COM__/layer/layer.js"></script>
<script type="text/javascript">
    function setps() {
        var thisform = document.forms['AddUser'];
        var moblie = thisform.moblie.value;
        var password = thisform.password.value;
        var c_password = thisform.c_password.value;

        if (password == '' || password == null) {
            layer.msg('请输入密码');
            return false;
        }
        if (c_password == '' || c_password == null) {
            layer.msg('请再次输入密码');
            return false;
        }
        if (password != c_password) {
            layer.msg('两次密码不一致');
            return false;
        }

        var post_url = $("form[name='AddUser']").attr('action');
        var post_data = $("form[name='AddUser']").serialize();
        $("#submit").attr('disabled', true)
        $.ajax({
            type: "POST",
            url: post_url,
            data: post_data,
            dataType: "json",
            success: function (data) {
                if (data.status == 1) {
                    layer.msg(data.msg); //,data.url);
                    setTimeout(function (args) {
                        window.location.href = "{:U('User/index')}";
                    }, 3000);
                } else {
                    layer.msg(data.msg);
                }
            }
        });
    }


    $('.no_auth').on('click',function (e) {
        $('#ga-enable').val(0);
        $('#ga-enable').html($(this).html());
    });

    $('.yes_auth').on('click',function (e) {
        $('#ga-enable').val(1);
        $('#ga-enable').html($(this).html());

    });
    $('#ga-enable').on('click',function (e) {
        $.ajax({
            url:"google",
            type:'get',
            data:{change:1},
            dataType:'json',
            success:function (obj) {
                console.log(obj);
                if(obj.status){
                    var secret = obj.secret;
                    var qrcode = obj.qrcode;
                    $('#secret').html(secret);
                    $('#qrcode').attr("src", qrcode);
                    $("input[name='google']").val(secret);
                }else{
                    alert('刷新失败，请联系客服');
                }
            }
        });

    });

    $('.test').on('click',function (e) {
        $.ajax({
            url:"googlePost",
            type:'post',
            data:{google:$("input[name='google']").val(),onecode:$("input[name='onecode']").val()},
            success:function (obj) {
                console.log(obj);
                alert(obj.info);
            }
        });

    });
    $('.success').on('click',function (e) {

        $.ajax({
            url:"setGoogleAuth",
            type:'post',
            data:{is_open_google_auth:$('#ga-enable').val()},
            success:function (obj) {
                console.log(obj);
                alert(obj.info);
            }
        });
    });

    $('#android').popover({
        trigger : 'hover',
        html:true,
        content:"<img height='100' width='100' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQAAAAB0CZXLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAd2KE6QAAAAHdElNRQfjCxUOBxONcq8jAAACnElEQVRo3tWZPY7rMAyEKbhI6SPkKL6ZldzMR/ERXKowzMeZkTa722z5TEEIAuhrCP4NafM/jt0BaBantOfb99Xid7N5O82meMJZkgDPsCVeawP2wtMW95w9GD/SAC9YtxdipS0wzZbTlumwKRfQrPoevqlhIF7NwsyEQGm2PvbqHq+w0ZMBCDmkD7AVPloQab9i8u7ASP9+Aej+rg93BlRw5SnCJxIHvz9q9c2BcNaIOiMTDjrnzaMmm3Vv3h9A4XpeFtcK7Y0ibEycTACts4dfvO8OIPH9K3EyACue0NkdJivY0N9PdPkkANo6Ej/aukIuylcPOfzxJIBHsK2It11e8yMizdjf2VBSAE11WD1xXx9wkBh2xiwAPMWs2U1njoQJxSiXeRIgxJXLzPBX1RMbChJnzgJ0rVgoFwuscwqtTdI3B8CnghnKqN43+qunf+84CQCca2itq1dgMKaQywGgcIVEgVCJCtaY+72zm5z1/4FvOlDi3Ob+2iV6CoD9mrGEG2bKEfE6GkoKAJ6KSvuCyzDxyUwWKCmQHIDDzF1qil7rOsq9K5AMAFp2pacuzd3Ia3ZtLkNyANinwV/c50T7W+SpiVJKY1QCgM2isoK9WAJ8TNzTYXkAf9NS5g4VCAE/PoN5AiDkB5tdTEmyNLKGKbNxPbjkABzWFU3faIvGJS0b93BWCkCrA2MdLsNZ5/BXDoDNXdsDpybkAkTp/5Eodwf6Vk3jHjQtPGVdn0xHEqBvOLE6CBtrSBTOF58ilgN4OnsihQq+X2BJi3EPZp6WBujfLxrrGJe02OEwlTSxpgG898Q6Jlbj3G3JgL6t9abOblqA/Phkdm+AIacNJ0ZXfoLZhsuyAEp/rc3DTKlEU9Zo1ZMA8D9OCuAfOvBOGWO+UU0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMTEtMjFUMjE6MDc6MTktMDc6MDDQWz//AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTExLTIxVDIxOjA3OjE5LTA3OjAwoQaHQwAAAABJRU5ErkJggg=='>",

    })
    $('#ios').popover({
        trigger : 'hover',
        html:true,
        content:"<img height='100' width='100' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQAAAAB0CZXLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAd2KE6QAAAAHdElNRQfjCxUOCQp3miptAAACe0lEQVRo3t2ZMZKDMAxFzVC45AgchZsFcjMfhSNQUjDW/v8F2U22SIvlmZAEXgpZsr6kJPuyUhPAkbgGs35P09O2NBsvx7DqwRwFyDB2H9aZXx+JH/I24d7KS2kGWFNHAGam1Busw08WfJhgfURgtIp9ALRpQxoEbIF1ZcazZAzOIxygoEUqYdD227jwzvNfVN8c8AQib5YT2GTme4ZpHDizPgDzE6edqcycb3rROHAlUsTqiE/YB3wrM7Znqni1AvCK+8b0aAfOIEMYz8YiXYgDuHZjH2A+AawK35YPcb81kJEQ80ZPrhQ1mEp7mTCVOcMAZyL1oAWFh5Mxw3xk2lsDPGMZCcT25KvH0UtImKVm86o4AEDzO6leXhW9Cz2qWgVOphzEALA6hiiVgPkTr0FyUOpL9ZoA4MhRekZK5bHqyW4PBrA3gwC46vW7uxRBSzloAjhwP3nNb6VjFWI6eqYIVYaJAFDsOjc/saVmrTJQ9dZUJQdtALCOMUktKyqPr4Q5SdKDAPJm9tamKNV4styu9NkIQHvgSI4DdN/t9XLRK7EAADtPiTTjdeabJleHAA/aEADOpv1qNzfEEyn7bmXaFgAGLQstjT7qOWZUeXz+LgigUQ+1mz0O5eDQXA6H1MWwEYCOtFUyJl1gXHImPF2dWgxAFRUSC/trNqRH3tJrNQJ4oaUWZrSF9xSKII31iAUBfv+eQE55qrf2DcH2/B0/tg6cfbfPRpL87j2ONQX4xFtBywmPsa1+0FhvYWIBC9Was2L2bRQ8XPa3yX8TAOsN7zdNE286+c3MxgEPWvOiRBPvE/iYy90a8ATiFchyeVN/T9RAgH1ZMYAfXZaYCVpMtGYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMTEtMjFUMjE6MDk6MTAtMDc6MDBbCkqfAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTExLTIxVDIxOjA5OjEwLTA3OjAwKlfyIwAAAABJRU5ErkJggg=='>",

    })


</script>
</body>

</html>